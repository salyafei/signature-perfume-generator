<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Al Nada • Fragrance Personality Quiz</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<style>
    :root {
        --earthy-green: #5A6F44;
        --ivory: #F5F0E1;
        --dark-green: #3E4B30;
        --sand: #D8C3A5;
        --gold-accent: #B89778;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Arial', sans-serif;
    }

    body {
        background-color: var(--ivory);
        color: var(--earthy-green);
        line-height: 1.6;
        direction: ltr;
    }

    .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }

    .header {
        text-align: center;
        margin-bottom: 40px;
    }

    .logo-img {
        max-width: 200px;
        margin-bottom: 10px;
    }

    h1 {
        font-size: 2.5rem;
        color: var(--dark-green);
    }

    #subtitle {
        font-size: 1.2rem;
        color: var(--gold-accent);
        margin-bottom: 20px;
    }

    .intro-text {
        font-size: 1rem;
        margin-bottom: 20px;
    }

    .intro-text[data-lang="ar"] {
        display: none;
        direction: rtl;
    }

    .input-group {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-bottom: 20px;
    }

    input, select {
        padding: 10px;
        border: 1px solid var(--sand);
        border-radius: 5px;
        font-size: 1rem;
    }

    #startQuizBtn {
        background-color: var(--earthy-green);
        color: var(--ivory);
        border: none;
        padding: 10px 20px;
        font-size: 1rem;
        border-radius: 5px;
        cursor: pointer;
    }

    #startQuizBtn:hover {
        background-color: var(--dark-green);
    }

    #langToggle {
        background: none;
        border: none;
        color: var(--gold-accent);
        font-size: 1rem;
        cursor: pointer;
        margin-bottom: 20px;
    }

    .quiz-section {
        display: none;
        text-align: center;
    }

    #questionText {
        font-size: 1.5rem;
        margin-bottom: 20px;
        color: var(--dark-green);
    }

    #optionsContainer {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
    }

    .option-card {
        background-color: var(--sand);
        padding: 15px;
        border-radius: 10px;
        cursor: pointer;
        transition: transform 0.2s, background-color 0.2s;
        text-align: center;
    }

    .option-card:hover {
        transform: scale(1.05);
        background-color: var(--gold-accent);
    }

    .option-card.selected {
        background-color: var(--earthy-green);
        color: var(--ivory);
        transform: scale(1.05);
    }

    .option-text {
        font-size: 1rem;
    }

    .progress-bar {
        width: 100%;
        background-color: var(--sand);
        height: 10px;
        border-radius: 5px;
        margin-bottom: 20px;
        overflow: hidden;
    }

    #progressFill {
        height: 100%;
        background-color: var(--earthy-green);
        width: 0;
        transition: width 0.3s ease;
    }

    .progress-text {
        font-size: 0.9rem;
        color: var(--dark-green);
        margin-bottom: 20px;
    }

    .nav-buttons {
        display: flex;
        justify-content: space-between;
    }

    #prevBtn, #nextBtn {
        background-color: var(--earthy-green);
        color: var(--ivory);
        border: none;
        padding: 10px 20px;
        font-size: 1rem;
        border-radius: 5px;
        cursor: pointer;
    }

    #prevBtn:hover, #nextBtn:hover {
        background-color: var(--dark-green);
    }

    #prevBtn:disabled, #nextBtn:disabled {
        background-color: var(--sand);
        cursor: not-allowed;
    }

    .result-section {
        display: none;
        text-align: center;
    }

    #resultSubtitle {
        font-size: 2rem;
        color: var(--dark-green);
        margin-bottom: 20px;
    }

    #personalityAnalysis {
        font-size: 1.1rem;
        margin-bottom: 20px;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
    }

    #fragranceComposition {
        margin-bottom: 20px;
    }

    .note-category {
        margin-bottom: 15px;
    }

    .note-category h3 {
        font-size: 1.2rem;
        color: var(--dark-green);
        margin-bottom: 5px;
    }

    .note-list {
        color: var(--earthy-green);
        font-weight: 500;
        white-space: normal;
    }

    #confidenceScore {
        font-size: 1rem;
        color: var(--gold-accent);
        margin-bottom: 20px;
    }

    .disclaimer {
        font-size: 0.9rem;
        color: var(--earthy-green);
        margin-top: 20px;
        text-align: center;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
    }

    #shareResultsBtn {
        background-color: var(--earthy-green);
        color: var(--ivory);
        border: none;
        padding: 10px 20px;
        font-size: 1rem;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 20px;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }

    #shareResultsBtn:hover {
        background-color: var(--dark-green);
    }

    @media (max-width: 600px) {
        h1 {
            font-size: 2rem;
        }

        #questionText {
            font-size: 1.2rem;
        }

        .option-card {
            padding: 10px;
        }

        #optionsContainer {
            grid-template-columns: 1fr;
        }
    }
</style>

<body>
    <div class="container">
        <div class="header">
            <img class="logo-img" src="logo.png" alt="Al Nada Logo">
            <h1>Al Nada • Fragrance Personality Quiz</h1>
            <p id="subtitle">Discover Your Scent</p>
            <p class="intro-text" data-lang="en">Embark on a sensory journey to uncover a fragrance that resonates with your unique personality. Answer the questions to reveal your signature scent.</p>
            <p class="intro-text" data-lang="ar">انطلق في رحلة حسية لاكتشاف عطر يعكس شخصيتك الفريدة. أجب على الأسئلة لتكشف عن عطرك المميز.</p>
            <div class="input-group">
                <input type="date" id="birthDateInput" required>
                <select id="ingredientPref">
                    <option value="both">Both Natural & Synthetic</option>
                    <option value="natural">Natural Only</option>
                    <option value="synthetic">Synthetic Only</option>
                </select>
                <button id="startQuizBtn">Start Quiz</button>
            </div>
            <button id="langToggle">العربية</button>
        </div>

        <div class="quiz-section">
            <p id="questionText"></p>
            <div id="optionsContainer"></div>
            <div class="progress-bar">
                <div id="progressFill"></div>
            </div>
            <p class="progress-text">Question <span id="currentQ"></span> of <span id="totalQ"></span></p>
            <div class="nav-buttons">
                <button id="prevBtn" disabled>Previous</button>
                <button id="nextBtn" disabled>Next</button>
            </div>
        </div>

        <div class="result-section">
            <h2 id="resultSubtitle">Your Signature Scent</h2>
            <div id="personalityAnalysis"></div>
            <div id="fragranceComposition"></div>
            <p id="confidenceScore"></p>
            <p class="disclaimer">Disclaimer: While the quiz is designed to obtain the fragrance notes closest your personality, your answer were the main driver to trigger the blend. Therefore, it is considered only an initial blend and it is not 100% match. Should you wish to fine tune it further with Perfume Nose Expert, you may share results by clicking the button below. Please note that a consultation fee of 50 AED will be incurred prior to having the consultation session.</p>
            <button id="shareResultsBtn">Share Results</button>
        </div>
    </div>

  <script>
    const PerfumeGenerator = {
        currentLang: 'en',
        currentQuestion: 0,
        answers: new Array(20).fill(undefined),
        responseTimes: new Array(20).fill(null),
        startTime: null,
        translations: {
            en: {
                discoverScent: 'Discover Your Signature Scent',
                startQuiz: 'Start Quiz',
                prev: 'Previous',
                next: 'Next',
                resultSubtitle: 'Your Signature Scent',
                arabic: 'العربية',
                english: 'English'
            },
            ar: {
                discoverScent: 'اكتشف عطرك المميز',
                startQuiz: 'ابدأ الاختبار',
                prev: 'السابق',
                next: 'التالي',
                resultSubtitle: 'عطرك المميز',
                arabic: 'العربية',
                english: 'English'
            }
        },
        categories: {
            style: ['elegant', 'bold', 'mysterious', 'refreshing', 'playful', 'sensual', 'exotic', 'minimalist', 'adventurous', 'classic', 'bohemian', 'modern'],
            emotion: ['serenity', 'confidence', 'intrigue', 'joy', 'excitement', 'romance', 'reflection', 'passion', 'power', 'melancholy', 'nostalgia', 'curiosity', 'calm', 'empathy', 'ambition'],
            family: ['oriental', 'spicy', 'woody', 'citrus', 'floral', 'gourmand', 'aquatic'],
            memory: ['celebration', 'childhood', 'travel', 'nature', 'romance', 'reflection']
        },
        score: {
            style: {},
            emotion: {},
            family: {},
            memory: {}
        },
        pyramidNotes: {
            oriental: [
                ['Saffron (N)', 'Cardamom (N)', 'Rose Absolute (N)', 'Neroli-Moroccan-Blossom-(N)', 'Bergamot-Calabrian-(N)', 'Rose-Moroccan-Valley-(N)', 'Saffron-Iranian-Absolute-(N)', 'Cardamom-Indian-Pod-(N)', 'Neroli-Tunisian-Blossom-(N)', 'Bergamot-Sicilian-Rind-(N)', 'Rose-Turkish-Absolute-(N)', 'Saffron-Turkish-Stigma-(N)', 'Cardamom-Sri-Lankan-(N)', 'Neroli-Egyptian-Blossom-(N)', 'Bergamot-Moroccan-Rind-(N)'],
                ['Jasmine Absolute (N)', 'Orris Root (N)', 'Ylang Ylang (N)', 'Tuberose Absolute (N)', 'Jasmine-Sambac-Indian-(N)', 'Orris-Moroccan-Rhizome-(N)', 'Ylang-Ylang-Madagascan-(N)', 'Tuberose-Indian-Moon-(N)', 'Jasmine-Egyptian-Dawn-(N)', 'Orris-Florentine-Root-(N)', 'Ylang-Ylang-Comorian-(N)', 'Tuberose-Mexican-Night-(N)', 'Jasmine-Moroccan-Night-(N)', 'Orris-Tuscan-Rhizome-(N)', 'Ylang-Ylang-Fijian-(N)'],
                ['Vanilla Absolute (N)', 'Musk Accord (B)', 'Tonka Bean (N)', 'Amber Accord (B)', 'Benzoin Siam (N)', 'Vanilla-Tahitian-Orchid-(N)', 'Musk-Oriental-Synthetic-(B)', 'Tonka-Venezuelan-Bean-(N)', 'Amber-Persian-Resin-(B)', 'Benzoin-Laotian-Gum-(N)', 'Vanilla-Madagascan-Pod-(N)', 'Musk-Egyptian-Synthetic-(B)', 'Tonka-Brazilian-Bean-(N)', 'Amber-Emirati-Glow-(B)', 'Benzoin-Thai-Resin-(N)', 'Vanilla-Comorian-Pod-(N)', 'Musk-Syrian-Soft-(B)', 'Tonka-Indian-Bean-(N)', 'Amber-Omani-Resin-(B)', 'Benzoin-Vietnamese-Gum-(N)']
            ],
            spicy: [
                ['Black Pepper (N)', 'Cinnamon (N)', 'Nutmeg (N)', 'Clove (N)', 'Pink Peppercorn (N)', 'Pink-Pepper-Brazilian-(N)', 'Cinnamon-Ceylon-Bark-(N)', 'Nutmeg-Indonesian-(N)', 'Clove-Madagascan-Bud-(N)', 'Black-Pepper-Indian-(N)', 'Cinnamon-Vietnamese-Bark-(N)', 'Nutmeg-Sri-Lankan-(N)', 'Clove-Zanzibar-Bud-(N)', 'Pink-Pepper-Reunion-(N)', 'Cinnamon-Tunisian-Bark-(N)', 'Nutmeg-Egyptian-(N)', 'Clove-Sri-Lankan-Bud-(N)', 'Black-Pepper-Vietnamese-(N)', 'Cinnamon-Moroccan-Bark-(N)', 'Nutmeg-Moroccan-(N)', 'Clove-Tunisian-Bud-(N)'],
                ['Cardamom Green (N)', 'Ginger Root (N)', 'Saffron (N)', 'Coriander Seed (N)', 'Pimento (N)', 'Cardamom-Guatemalan-Pod-(N)', 'Ginger-Zanzibar-Root-(N)', 'Saffron-Iranian-Absolute-(N)', 'Coriander-Moroccan-Seed-(N)', 'Pimento-Jamaican-Berry-(N)', 'Cardamom-Sri-Lankan-(N)', 'Ginger-Indian-Root-(N)', 'Saffron-Turkish-Stigma-(N)', 'Coriander-Egyptian-Seed-(N)', 'Pimento-Honduran-Berry-(N)', 'Cardamom-Indian-(N)', 'Ginger-Thai-Root-(N)', 'Saffron-Moroccan-Absolute-(N)', 'Coriander-Tunisian-Seed-(N)', 'Pimento-Cuban-Berry-(N)'],
                ['Sandalwood (N)', 'Patchouli (N)', 'Vetiver Base (N)', 'Oud Base (B)', 'Tobacco Leaf (N)', 'Sandalwood-Fijian-Soft-(N)', 'Patchouli-Indonesian-Deep-(N)', 'Vetiver-Haitian-Root-(N)', 'Oud-Malay-Wood-(N)', 'Tobacco-Virginian-Leaf-(N)', 'Sandalwood-Australian-Creamy-(N)', 'Patchouli-Sumatran-(N)', 'Vetiver-Javanese-Root-(N)', 'Oud-Assam-Wood-(N)', 'Tobacco-Cuban-Leaf-(N)', 'Sandalwood-Sri-Lankan-(N)', 'Patchouli-Tunisian-(N)', 'Vetiver-Indian-Root-(N)', 'Oud-Cambodian-Wood-(N)', 'Tobacco-Moroccan-Leaf-(N)']
            ],
            woody: [
                ['Cedarwood (N)', 'Pine Needle (N)', 'Juniper Berry (N)', 'Bergamot (N)', 'Cypress (N)', 'Cedar-Himalayan-Leaf-(N)', 'Pine-Moroccan-Needle-(N)', 'Juniper-Himalayan-Berry-(N)', 'Bergamot-Calabrian-Rind-(N)', 'Cypress-Mediterranean-(N)', 'Cedar-Virginian-Needle-(N)', 'Pine-Siberian-Needle-(N)', 'Juniper-Macedonian-Berry-(N)', 'Bergamot-Sicilian-Rind-(N)', 'Cypress-Moroccan-Branch-(N)', 'Cedar-Texan-Leaf-(N)', 'Pine-Canadian-Needle-(N)', 'Juniper-Utah-Berry-(N)', 'Bergamot-Moroccan-Rind-(N)', 'Cypress-Tuscan-Branch-(N)'],
                ['Vetiver (N)', 'Patchouli (N)', 'Sandalwood Heart (N)', 'Rosewood (N)', 'Guaiac Wood (N)', 'Vetiver-Haitian-Root-(N)', 'Patchouli-Bangladeshi-(N)', 'Sandalwood-Fijian-Soft-(N)', 'Rosewood-Brazilian-(N)', 'Guaiac-Brazilian-Wood-(N)', 'Vetiver-Javanese-Root-(N)', 'Patchouli-Sumatran-(N)', 'Sandalwood-Australian-Creamy-(N)', 'Rosewood-Indian-(N)', 'Guaiac-Paraguayan-Wood-(N)', 'Vetiver-Indian-Root-(N)', 'Patchouli-Tunisian-(N)', 'Sandalwood-Sri-Lankan-(N)', 'Rosewood-Thai-(N)', 'Guaiac-Argentinian-Wood-(N)'],
                ['Oud Wood (N)', 'Cedar Base (N)', 'Patchouli Base (N)', 'Myrrh (N)', 'Labdanum (N)', 'Oud-Malay-Wood-(N)', 'Cedar-Moroccan-Bark-(N)', 'Patchouli-Indonesian-Deep-(N)', 'Myrrh-Yemeni-Sacred-(N)', 'Labdanum-Moroccan-Resin-(N)', 'Oud-Assam-Wood-(N)', 'Cedar-Virginian-Bark-(N)', 'Patchouli-Sumatran-(N)', 'Myrrh-Ethiopian-Resin-(N)', 'Labdanum-Spanish-Resin-(N)', 'Oud-Cambodian-Wood-(N)', 'Cedar-Lebanese-Bark-(N)', 'Patchouli-Tunisian-(N)', 'Myrrh-Somali-Resin-(N)', 'Labdanum-Tunisian-Resin-(N)']
            ],
            citrus: [
                ['Bergamot (N)', 'Lemon Zest (N)', 'Orange Peel (N)', 'Grapefruit (N)', 'Mandarin (N)', 'Bergamot-Calabrian-Rind-(N)', 'Lemon-Sicilian-Zest-(N)', 'Orange-Brazilian-Peel-(N)', 'Grapefruit-Florida-Pink-(N)', 'Mandarin-Italian-Zest-(N)', 'Bergamot-Sicilian-Rind-(N)', 'Lemon-Amalfi-Zest-(N)', 'Orange-Spanish-Peel-(N)', 'Grapefruit-Texas-White-(N)', 'Mandarin-Moroccan-Zest-(N)', 'Bergamot-Moroccan-Rind-(N)', 'Lemon-Californian-Zest-(N)', 'Orange-Florida-Peel-(N)', 'Grapefruit-South-African-(N)', 'Mandarin-Sicilian-Zest-(N)'],
                ['Lime Blossom (N)', 'Petitgrain (N)', 'Neroli (N)', 'Orange Blossom (N)', 'Lemongrass (N)', 'Lime-Mexican-Blossom-(N)', 'Petitgrain-Paraguayan-Leaf-(N)', 'Neroli-Tunisian-Blossom-(N)', 'Orange-Blossom-Moroccan-(N)', 'Lemongrass-Thai-Stalk-(N)', 'Lime-Brazilian-Blossom-(N)', 'Petitgrain-Sicilian-Leaf-(N)', 'Neroli-Moroccan-Blossom-(N)', 'Orange-Blossom-Tunisian-(N)', 'Lemongrass-Vietnamese-(N)', 'Lime-Florida-Blossom-(N)', 'Petitgrain-Moroccan-Leaf-(N)', 'Neroli-Egyptian-Blossom-(N)', 'Orange-Blossom-Egyptian-(N)', 'Lemongrass-Indian-Stalk-(N)'],
                ['Ambergris Synthetic (B)', 'Musk Base (B)', 'Cedarwood Base (N)', 'Vetiver Base (N)', 'Citrus Musk (B)', 'Ambergris-Atlantic-Synthetic-(B)', 'Musk-Tunisian-Synthetic-(B)', 'Cedar-Moroccan-Bark-(N)', 'Vetiver-Haitian-Root-(N)', 'Citrus-Musk-Mediterranean-(B)', 'Ambergris-Pacific-Synthetic-(B)', 'Musk-Moroccan-Synthetic-(B)', 'Cedar-Virginian-Bark-(N)', 'Vetiver-Javanese-Root-(N)', 'Citrus-Musk-Pacific-(B)', 'Ambergris-Mediterranean-Synthetic-(B)', 'Musk-Egyptian-Synthetic-(B)', 'Cedar-Lebanese-Bark-(N)', 'Vetiver-Indian-Root-(N)', 'Citrus-Musk-Atlantic-(B)']
            ],
            floral: [
                ['Rose Petal (N)', 'Jasmine Bud (N)', 'Neroli Blossom (N)', 'Peony (N)', 'Lily (N)', 'Rose-Moroccan-Valley-(N)', 'Jasmine-Egyptian-Dawn-(N)', 'Neroli-Tunisian-Blossom-(N)', 'Peony-Chinese-Pink-(N)', 'Lily-of-the-Valley-French-(N)', 'Rose-Turkish-Absolute-(N)', 'Jasmine-Sambac-Indian-(N)', 'Neroli-Moroccan-Blossom-(N)', 'Peony-Japanese-White-(N)', 'Lily-of-the-Valley-English-(N)', 'Rose-Bulgarian-Petal-(N)', 'Jasmine-Moroccan-Night-(N)', 'Neroli-Egyptian-Blossom-(N)', 'Peony-Korean-Red-(N)', 'Lily-of-the-Valley-Italian-(N)'],
                ['Tuberose (N)', 'Ylang Ylang (N)', 'Magnolia (N)', 'Gardenia (N)', 'Frangipani (N)', 'Tuberose-Indian-Moon-(N)', 'Ylang-Ylang-Madagascan-(N)', 'Magnolia-Chinese-Blossom-(N)', 'Gardenia-Tahitian-(N)', 'Frangipani-Thai-Temple-(N)', 'Tuberose-Mexican-Night-(N)', 'Ylang-Ylang-Comorian-(N)', 'Magnolia-Indian-Creamy-(N)', 'Gardenia-Fijian-(N)', 'Frangipani-Seychelles-(N)', 'Tuberose-Indian-Sunset-(N)', 'Ylang-Ylang-Fijian-(N)', 'Magnolia-Vietnamese-Blossom-(N)', 'Gardenia-Hawaiian-(N)', 'Frangipani-Balinese-(N)'],
                ['Vanilla Base (N)', 'Musk Base (B)', 'Sandalwood Base (N)', 'Orris Root (N)', 'Iris Absolute (N)', 'Vanilla-Tahitian-Orchid-(N)', 'Musk-Floral-Synthetic-(B)', 'Sandalwood-Australian-Creamy-(N)', 'Orris-Florentine-Root-(N)', 'Iris-Florentine-Rhizome-(N)', 'Vanilla-Madagascan-Pod-(N)', 'Musk-Oriental-Synthetic-(B)', 'Sandalwood-Fijian-Soft-(N)', 'Orris-Moroccan-Rhizome-(N)', 'Iris-Tuscan-Rhizome-(N)', 'Vanilla-Comorian-Pod-(N)', 'Musk-Syrian-Soft-(B)', 'Sandalwood-Sri-Lankan-(N)', 'Orris-Tuscan-Root-(N)', 'Iris-Moroccan-Rhizome-(N)']
            ],
            gourmand: [
                ['Cocoa Powder (N)', 'Coffee Bean (N)', 'Almond (N)', 'Caramel (N)', 'Honey (N)', 'Cocoa-Brazilian-Bean-(N)', 'Coffee-Ethiopian-Roast-(N)', 'Almond-Moroccan-Roasted-(N)', 'Caramel-Salted-Breton-(N)', 'Honey-Tunisian-Wild-(N)', 'Cocoa-Venezuelan-Powder-(N)', 'Coffee-Colombian-Roast-(N)', 'Almond-Spanish-Roasted-(N)', 'Caramel-French-Burnt-(N)', 'Honey-Moroccan-Citrus-(N)', 'Cocoa-Peruvian-Bean-(N)', 'Coffee-Yemeni-Roast-(N)', 'Almond-Italian-Roasted-(N)', 'Caramel-Dutch-Stroop-(N)', 'Honey-Lebanese-Clover-(N)'],
                ['Vanilla Cream (N)', 'Tonka Bean (N)', 'Hazelnut (N)', 'Praline (N)', 'Chestnut (N)', 'Vanilla-Creole-Cream-(N)', 'Tonka-Venezuelan-Bean-(N)', 'Hazelnut-Turkish-Roast-(N)', 'Praline-French-Candy-(N)', 'Chestnut-Tuscan-Roast-(N)', 'Vanilla-Bourbon-Cream-(N)', 'Tonka-Brazilian-Bean-(N)', 'Hazelnut-Italian-Roast-(N)', 'Praline-Belgian-(N)', 'Chestnut-French-Cream-(N)', 'Vanilla-Tahitian-Cream-(N)', 'Tonka-Indian-Bean-(N)', 'Hazelnut-Spanish-Roast-(N)', 'Praline-Swiss-Candy-(N)', 'Chestnut-Spanish-Roast-(N)'],
                ['Chocolate Base (N)', 'Caramel Base (B)', 'Vanilla Base (N)', 'Musk Base (B)', 'Toffee (N)', 'Chocolate-Mexican-Dark-(N)', 'Caramel-Argentinian-(B)', 'Vanilla-Madagascan-Pod-(N)', 'Musk-Gourmand-Synthetic-(B)', 'Toffee-English-Sticky-(N)', 'Chocolate-Venezuelan-Dark-(N)', 'Caramel-Spanish-Dulce-(B)', 'Vanilla-Tahitian-Orchid-(N)', 'Musk-Tunisian-Synthetic-(B)', 'Toffee-Scottish-(N)', 'Chocolate-Brazilian-Dark-(N)', 'Caramel-Dutch-Stroop-(B)', 'Vanilla-Comorian-Pod-(N)', 'Musk-Moroccan-Synthetic-(B)', 'Toffee-Irish-Cream-(N)']
            ],
            aquatic: [
                ['Marine Accord (B)', 'Sea Salt (N)', 'Calone (B)', 'Cucumber (N)', 'Melon (N)', 'Marine-Atlantic-Breeze-(B)', 'Sea-Salt-Mediterranean-(N)', 'Calone-Oceanic-Synthetic-(B)', 'Cucumber-English-Fresh-(N)', 'Melon-Cantaloupe-French-(N)', 'Marine-Pacific-Wave-(B)', 'Sea-Salt-Atlantic-(N)', 'Calone-Aquatic-Synthetic-(B)', 'Cucumber-Mediterranean-(N)', 'Melon-Honeydew-Italian-(N)', 'Marine-Caribbean-Breeze-(B)', 'Sea-Salt-Pacific-(N)', 'Calone-Marine-Synthetic-(B)', 'Cucumber-Japanese-Fresh-(N)', 'Melon-Watermelon-Greek-(N)'],
                ['Water Lily (N)', 'Lotus Blossom (N)', 'Aquatic Accord (B)', 'Aloe Vera (N)', 'Seaweed (N)', 'Water-Lily-Vietnamese-(N)', 'Lotus-Thai-White-(N)', 'Aquatic-Oceanic-Accord-(B)', 'Aloe-Vera-Mexican-(N)', 'Seaweed-Irish-Moss-(N)', 'Water-Lily-Indian-(N)', 'Lotus-Indian-Blue-(N)', 'Aquatic-Rain-Accord-(B)', 'Aloe-Vera-South-African-(N)', 'Seaweed-Japanese-Nori-(N)', 'Water-Lily-Thai-(N)', 'Lotus-Vietnamese-Pink-(N)', 'Aquatic-Lake-Accord-(B)', 'Aloe-Vera-Tunisian-(N)', 'Seaweed-Scottish-Kelp-(N)'],
                ['Ambergris Base (B)', 'Musk Base (B)', 'Driftwood (N)', 'Sea Moss (N)', 'Kelp (N)', 'Ambergris-Atlantic-Synthetic-(B)', 'Musk-Aquatic-Synthetic-(B)', 'Driftwood-Mediterranean-(N)', 'Sea-Moss-Irish-(N)', 'Kelp-Icelandic-Sea-(N)', 'Ambergris-Pacific-Synthetic-(B)', 'Musk-Marine-Synthetic-(B)', 'Driftwood-Pacific-(N)', 'Sea-Moss-Scottish-(N)', 'Kelp-Atlantic-Sea-(N)', 'Ambergris-Mediterranean-Synthetic-(B)', 'Musk-Oceanic-Synthetic-(B)', 'Driftwood-Atlantic-(N)', 'Sea-Moss-Norwegian-(N)', 'Kelp-Pacific-Sea-(N)']
            ]
        },
        traitToNoteMap: {
            elegant: ["Rose Petal (N)", "Orris Root (N)", "Neroli (N)", "Sandalwood (N)", "Vanilla (N)", "Rose-Moroccan-Valley-(N)", "Orris-Florentine-Root-(N)", "Neroli-Tunisian-Blossom-(N)", "Sandalwood-Australian-Creamy-(N)", "Vanilla-Tahitian-Orchid-(N)", "Rose-Turkish-Absolute-(N)", "Orris-Moroccan-Rhizome-(N)", "Neroli-Moroccan-Blossom-(N)", "Sandalwood-Fijian-Soft-(N)", "Vanilla-Madagascan-Pod-(N)", "Rose-Bulgarian-Petal-(N)", "Orris-Tuscan-Root-(N)", "Neroli-Egyptian-Blossom-(N)", "Sandalwood-Sri-Lankan-(N)", "Vanilla-Comorian-Pod-(N)"],
            bold: ["Black Pepper (N)", "Ginger (N)", "Nutmeg (N)", "Pink Peppercorn (N)", "Clove Bud (N)", "Pink-Pepper-Brazilian-(N)", "Ginger-Zanzibar-Root-(N)", "Nutmeg-Indonesian-(N)", "Clove-Madagascan-Bud-(N)", "Black-Pepper-Indian-(N)", "Pink-Pepper-Reunion-(N)", "Ginger-Indian-Root-(N)", "Nutmeg-Sri-Lankan-(N)", "Clove-Zanzibar-Bud-(N)", "Black-Pepper-Vietnamese-(N)", "Pink-Pepper-Indian-(N)", "Ginger-Thai-Root-(N)", "Nutmeg-Egyptian-(N)", "Clove-Sri-Lankan-Bud-(N)", "Black-Pepper-Sri-Lankan-(N)", "Pink-Pepper-Moroccan-(N)", "Ginger-Moroccan-Root-(N)", "Nutmeg-Moroccan-(N)", "Clove-Tunisian-Bud-(N)", "Black-Pepper-Madagascan-(N)", "Pink-Pepper-Tunisian-(N)", "Ginger-Sri-Lankan-Root-(N)", "Nutmeg-Tunisian-(N)", "Clove-Lebanese-Bud-(N)"],
            mysterious: ["Oud Wood (N)", "Myrrh (N)", "Labdanum (N)", "Patchouli (N)", "Incense (N)", "Oud-Malay-Wood-(N)", "Myrrh-Yemeni-Sacred-(N)", "Labdanum-Moroccan-Resin-(N)", "Patchouli-Indonesian-Deep-(N)", "Incense-Omani-Sacred-(N)", "Oud-Assam-Wood-(N)", "Myrrh-Ethiopian-Resin-(N)", "Labdanum-Spanish-Resin-(N)", "Patchouli-Sumatran-(N)", "Incense-Indian-Temple-(N)", "Oud-Cambodian-Wood-(N)", "Myrrh-Somali-Resin-(N)", "Labdanum-Tunisian-Resin-(N)", "Patchouli-Tunisian-(N)", "Incense-Egyptian-Sacred-(N)"],
            refreshing: ["Bergamot (N)", "Lemon Zest (N)", "Sea Salt (N)", "Marine Accord (B)", "Lime (N)", "Bergamot-Calabrian-Rind-(N)", "Lemon-Sicilian-Zest-(N)", "Sea-Salt-Mediterranean-(N)", "Marine-Atlantic-Breeze-(B)", "Lime-Mexican-Zest-(N)", "Bergamot-Sicilian-Rind-(N)", "Lemon-Amalfi-Zest-(N)", "Sea-Salt-Atlantic-(N)", "Marine-Pacific-Wave-(B)", "Lime-Brazilian-Zest-(N)", "Bergamot-Moroccan-Rind-(N)", "Lemon-Californian-Zest-(N)", "Sea-Salt-Pacific-(N)", "Marine-Caribbean-Breeze-(B)", "Lime-Florida-Zest-(N)"],
            playful: ["Mandarin (N)", "Orange Peel (N)", "Melon (N)", "Candy Accord (B)", "Apple (N)", "Mandarin-Italian-Zest-(N)", "Orange-Brazilian-Peel-(N)", "Melon-Cantaloupe-French-(N)", "Candy-Cotton-Synthetic-(B)", "Apple-Granny-Smith-(N)", "Mandarin-Moroccan-Zest-(N)", "Orange-Spanish-Peel-(N)", "Melon-Honeydew-Italian-(N)", "Candy-Sugar-Synthetic-(B)", "Apple-Gala-New-Zealand-(N)", "Mandarin-Sicilian-Zest-(N)", "Orange-Florida-Peel-(N)", "Melon-Watermelon-Greek-(N)", "Candy-Gummy-Synthetic-(B)", "Apple-Fuji-Japanese-(N)"],
            sensual: ["Jasmine Absolute (N)", "Tuberose (N)", "Ylang Ylang (N)", "Amber Accord (B)", "Musk Accord (B)", "Jasmine-Sambac-Indian-(N)", "Tuberose-Indian-Moon-(N)", "Ylang-Ylang-Madagascan-(N)", "Amber-Persian-Resin-(B)", "Musk-Oriental-Synthetic-(B)", "Jasmine-Egyptian-Dawn-(N)", "Tuberose-Mexican-Night-(N)", "Ylang-Ylang-Comorian-(N)", "Amber-Emirati-Glow-(B)", "Musk-Syrian-Soft-(B)", "Jasmine-Moroccan-Night-(N)", "Tuberose-Indian-Sunset-(N)", "Ylang-Ylang-Fijian-(N)", "Amber-Omani-Resin-(B)", "Musk-Egyptian-Synthetic-(B)"],
            exotic: ["Saffron (N)", "Cardamom (N)", "Oud Base (B)", "Sandalwood (N)", "Spice Accord (B)", "Saffron-Iranian-Absolute-(N)", "Cardamom-Guatemalan-Pod-(N)", "Oud-Malay-Wood-(N)", "Sandalwood-Fijian-Soft-(N)", "Spice-Moroccan-Blend-(B)", "Saffron-Turkish-Stigma-(N)", "Cardamom-Sri-Lankan-(N)", "Oud-Assam-Wood-(N)", "Sandalwood-Australian-Creamy-(N)", "Spice-Indian-Bazaar-(B)", "Saffron-Moroccan-Absolute-(N)", "Cardamom-Indian-(N)", "Oud-Cambodian-Wood-(N)", "Sandalwood-Sri-Lankan-(N)", "Spice-Tunisian-Market-(B)"],
            minimalist: ["Sea Salt (N)", "Driftwood (N)", "White Musk (B)", "Aloe Vera (N)", "Cotton Accord (B)", "Sea-Salt-Mediterranean-(N)", "Driftwood-Mediterranean-(N)", "White-Musk-Atlantic-(B)", "Aloe-Vera-Mexican-(N)", "Cotton-Linen-Synthetic-(B)", "Sea-Salt-Atlantic-(N)", "Driftwood-Pacific-(N)", "White-Musk-Pacific-(B)", "Aloe-Vera-South-African-(N)", "Cotton-Fresh-Synthetic-(B)", "Sea-Salt-Pacific-(N)", "Driftwood-Atlantic-(N)", "White-Musk-Caribbean-(B)", "Aloe-Vera-Tunisian-(N)", "Cotton-Breeze-Synthetic-(B)"],
            adventurous: ["Juniper Berry (N)", "Pine Needle (N)", "Leather Accord (B)", "Vetiver (N)", "Tobacco Leaf (N)", "Juniper-Himalayan-Berry-(N)", "Pine-Moroccan-Needle-(N)", "Leather-Spanish-Accord-(B)", "Vetiver-Haitian-Root-(N)", "Tobacco-Virginian-Leaf-(N)", "Juniper-Macedonian-Berry-(N)", "Pine-Siberian-Needle-(N)", "Leather-Moroccan-Accord-(B)", "Vetiver-Javanese-Root-(N)", "Tobacco-Cuban-Leaf-(N)", "Juniper-Utah-Berry-(N)", "Pine-Canadian-Needle-(N)", "Leather-Tunisian-Accord-(B)", "Vetiver-Indian-Root-(N)", "Tobacco-Moroccan-Leaf-(N)"],
            classic: ["Rose Absolute (N)", "Jasmine Absolute (N)", "Sandalwood Base (N)", "Vanilla Base (N)", "Musk Base (B)", "Rose-Turkish-Absolute-(N)", "Jasmine-Sambac-Indian-(N)", "Sandalwood-Australian-Creamy-(N)", "Vanilla-Tahitian-Orchid-(N)", "Musk-Floral-Synthetic-(B)", "Rose-Bulgarian-Petal-(N)", "Jasmine-Egyptian-Dawn-(N)", "Sandalwood-Fijian-Soft-(N)", "Vanilla-Madagascan-Pod-(N)", "Musk-Oriental-Synthetic-(B)", "Rose-Moroccan-Valley-(N)", "Jasmine-Moroccan-Night-(N)", "Sandalwood-Sri-Lankan-(N)", "Vanilla-Comorian-Pod-(N)", "Musk-Syrian-Soft-(B)"],
            bohemian: ["Patchouli (N)", "Rose Petal (N)", "Saffron (N)", "Amber Accord (B)", "Musk Accord (B)", "Patchouli-Indonesian-Deep-(N)", "Rose-Moroccan-Valley-(N)", "Saffron-Iranian-Absolute-(N)", "Amber-Persian-Resin-(B)", "Musk-Oriental-Synthetic-(B)", "Patchouli-Sumatran-(N)", "Rose-Turkish-Absolute-(N)", "Saffron-Turkish-Stigma-(N)", "Amber-Emirati-Glow-(B)", "Musk-Syrian-Soft-(B)", "Patchouli-Tunisian-(N)", "Rose-Bulgarian-Petal-(N)", "Saffron-Moroccan-Absolute-(N)", "Amber-Omani-Resin-(B)", "Musk-Egyptian-Synthetic-(B)"],
            modern: ["Calone (B)", "Citrus Musk (B)", "Aquatic Accord (B)", "Cedarwood (N)", "White Musk (B)", "Calone-Oceanic-Synthetic-(B)", "Citrus-Musk-Mediterranean-(B)", "Aquatic-Oceanic-Accord-(B)", "Cedar-Himalayan-Leaf-(N)", "White-Musk-Atlantic-(B)", "Calone-Aquatic-Synthetic-(B)", "Citrus-Musk-Pacific-(B)", "Aquatic-Rain-Accord-(B)", "Cedar-Virginian-Needle-(N)", "White-Musk-Pacific-(B)", "Calone-Marine-Synthetic-(B)", "Citrus-Musk-Atlantic-(B)", "Aquatic-Lake-Accord-(B)", "Cedar-Moroccan-Bark-(N)", "White-Musk-Caribbean-(B)"],
            serenity: ["Lavender (N)", "Chamomile (N)", "White Musk (B)", "Aloe Vera (N)", "Lotus (N)", "Lavender-French-Fields-(N)", "Chamomile-English-(N)", "White-Musk-Atlantic-(B)", "Aloe-Vera-Mexican-(N)", "Lotus-Thai-White-(N)", "Lavender-Provence-(N)", "Chamomile-Roman-(N)", "White-Musk-Pacific-(B)", "Aloe-Vera-South-African-(N)", "Lotus-Indian-Blue-(N)", "Lavender-Bulgarian-(N)", "Chamomile-German-(N)", "White-Musk-Caribbean-(B)", "Aloe-Vera-Tunisian-(N)", "Lotus-Vietnamese-Pink-(N)"],
            confidence: ["Cedar Heart (N)", "Musk (B)", "Clove (N)", "Sandalwood (N)", "Oud Synthetic (B)", "Cedar-Moroccan-Bark-(N)", "Musk-Tunisian-Synthetic-(B)", "Clove-Madagascan-Bud-(N)", "Sandalwood-Australian-Creamy-(N)", "Oud-Indian-Synthetic-(B)", "Cedar-Virginian-Bark-(N)", "Musk-Moroccan-Synthetic-(B)", "Clove-Zanzibar-Bud-(N)", "Sandalwood-Fijian-Soft-(N)", "Oud-Vietnamese-Synthetic-(B)", "Cedar-Lebanese-Bark-(N)", "Musk-Syrian-Synthetic-(B)", "Clove-Sri-Lankan-Bud-(N)", "Sandalwood-Sri-Lankan-(N)", "Oud-Thai-Synthetic-(B)", "Cedar-Texan-Bark-(N)", "Musk-Egyptian-Synthetic-(B)", "Clove-Tunisian-Bud-(N)", "Sandalwood-Mauritian-(N)", "Oud-Moroccan-Synthetic-(B)"],
            intrigue: ["Incense (N)", "Myrrh (N)", "Oud Wood (N)", "Saffron (N)", "Patchouli (N)", "Incense-Omani-Sacred-(N)", "Myrrh-Yemeni-Sacred-(N)", "Oud-Malay-Wood-(N)", "Saffron-Iranian-Absolute-(N)", "Patchouli-Indonesian-Deep-(N)", "Incense-Indian-Temple-(N)", "Myrrh-Ethiopian-Resin-(N)", "Oud-Assam-Wood-(N)", "Saffron-Turkish-Stigma-(N)", "Patchouli-Sumatran-(N)", "Incense-Egyptian-Sacred-(N)", "Myrrh-Somali-Resin-(N)", "Oud-Cambodian-Wood-(N)", "Saffron-Moroccan-Absolute-(N)", "Patchouli-Tunisian-(N)"],
            joy: ["Orange Peel (N)", "Mandarin (N)", "Lemon Zest (N)", "Grapefruit (N)", "Melon (N)", "Orange-Brazilian-Peel-(N)", "Mandarin-Italian-Zest-(N)", "Lemon-Sicilian-Zest-(N)", "Grapefruit-Florida-Pink-(N)", "Melon-Cantaloupe-French-(N)", "Orange-Spanish-Peel-(N)", "Mandarin-Moroccan-Zest-(N)", "Lemon-Amalfi-Zest-(N)", "Grapefruit-Texas-White-(N)", "Melon-Honeydew-Italian-(N)", "Orange-Florida-Peel-(N)", "Mandarin-Sicilian-Zest-(N)", "Lemon-Californian-Zest-(N)", "Grapefruit-South-African-(N)", "Melon-Watermelon-Greek-(N)"],
            excitement: ["Pink Peppercorn (N)", "Ginger Root (N)", "Cinnamon Bark (N)", "Cardamom (N)", "Clove (N)", "Pink-Pepper-Brazilian-(N)", "Ginger-Zanzibar-Root-(N)", "Cinnamon-Ceylon-Bark-(N)", "Cardamom-Guatemalan-Pod-(N)", "Clove-Madagascan-Bud-(N)", "Pink-Pepper-Reunion-(N)", "Ginger-Indian-Root-(N)", "Cinnamon-Vietnamese-Bark-(N)", "Cardamom-Sri-Lankan-(N)", "Clove-Zanzibar-Bud-(N)", "Pink-Pepper-Indian-(N)", "Ginger-Thai-Root-(N)", "Cinnamon-Tunisian-Bark-(N)", "Cardamom-Indian-(N)", "Clove-Sri-Lankan-Bud-(N)"],
            romance: ["Rose Absolute (N)", "Jasmine Absolute (N)", "Tuberose (N)", "Ylang Ylang (N)", "Vanilla (N)", "Rose-Turkish-Absolute-(N)", "Jasmine-Sambac-Indian-(N)", "Tuberose-Indian-Moon-(N)", "Ylang-Ylang-Madagascan-(N)", "Vanilla-Tahitian-Orchid-(N)", "Rose-Bulgarian-Petal-(N)", "Jasmine-Egyptian-Dawn-(N)", "Tuberose-Mexican-Night-(N)", "Ylang-Ylang-Comorian-(N)", "Vanilla-Madagascan-Pod-(N)", "Rose-Moroccan-Valley-(N)", "Jasmine-Moroccan-Night-(N)", "Tuberose-Indian-Sunset-(N)", "Ylang-Ylang-Fijian-(N)", "Vanilla-Comorian-Pod-(N)"],
            reflection: ["Sandalwood Base (N)", "Benzoin (N)", "Iris Root (N)", "Benzoin Siam (N)", "Orris Concrete (N)", "Sandalwood-Australian-Creamy-(N)", "Benzoin-Laotian-Gum-(N)", "Iris-Florentine-Rhizome-(N)", "Benzoin-Thai-Resin-(N)", "Orris-Moroccan-Rhizome-(N)", "Sandalwood-Fijian-Soft-(N)", "Benzoin-Vietnamese-Gum-(N)", "Iris-Tuscan-Rhizome-(N)", "Benzoin-Indonesian-Resin-(N)", "Orris-Tuscan-Root-(N)"],
            passion: ["Chili Pepper (N)", "Cinnamon Bark (N)", "Jasmine (N)", "Amber (N)", "Nutmeg (N)", "Chili-Pepper-Indian-(N)", "Cinnamon-Ceylon-Bark-(N)", "Jasmine-Tunisian-Dawn-(N)", "Amber-Syrian-Resin-(N)", "Nutmeg-Moroccan-(N)", "Chili-Pepper-Moroccan-(N)", "Cinnamon-Tunisian-Bark-(N)", "Jasmine-Syrian-Night-(N)", "Amber-Egyptian-Resin-(N)", "Chili-Pepper-Tunisian-(N)", "Cinnamon-Lebanese-Bark-(N)"],
            power: ["Black Pepper (N)", "Sandalwood (N)", "Musk Base (B)", "Oud Synthetic (B)", "Leather Accord (B)", "Oud-Indian-Synthetic-(B)", "Leather-Spanish-Accord-(B)", "Sandalwood-Fijian-Soft-(N)", "Musk-Tunisian-Synthetic-(B)", "Oud-Vietnamese-Synthetic-(B)", "Black-Pepper-Madagascan-(N)", "Sandalwood-Australian-Creamy-(N)", "Musk-Moroccan-Synthetic-(B)", "Oud-Thai-Synthetic-(B)", "Leather-Moroccan-Accord-(B)", "Black-Pepper-Vietnamese-(N)", "Sandalwood-Sri-Lankan-(N)", "Musk-Syrian-Synthetic-(B)", "Oud-Moroccan-Synthetic-(B)", "Leather-Tunisian-Accord-(B)", "Black-Pepper-Indian-(N)", "Sandalwood-Mauritian-(N)", "Musk-Lebanese-Synthetic-(B)", "Oud-Tunisian-Synthetic-(B)", "Leather-Egyptian-Accord-(B)", "Black-Pepper-Sri-Lankan-(N)", "Sandalwood-Thai-Creamy-(N)", "Musk-Turkish-Synthetic-(B)", "Oud-Syrian-Synthetic-(B)", "Leather-Lebanese-Accord-(B)"],
            melancholy: ["Seaweed (N)", "Oakmoss (N)", "Vanilla Base (N)", "Kelp (N)", "Sea Moss (N)", "Kelp-Icelandic-Sea-(N)", "Moss-Irish-Sea-(N)", "Seaweed-Japanese-Nori-(N)", "Oakmoss-Tunisian-(N)", "Vanilla-Comorian-Base-(N)", "Kelp-Moroccan-Coast-(N)", "Moss-Scottish-Sea-(N)", "Seaweed-Irish-Moss-(N)", "Oakmoss-Lebanese-(N)", "Vanilla-Madagascan-Base-(N)", "Kelp-Atlantic-Sea-(N)", "Moss-Norwegian-Sea-(N)", "Seaweed-Scottish-Kelp-(N)", "Oakmoss-Moroccan-(N)", "Vanilla-Papua-Base-(N)", "Kelp-Pacific-Sea-(N)", "Moss-Mediterranean-Sea-(N)", "Seaweed-Norwegian-(N)", "Oakmoss-Turkish-(N)", "Vanilla-Fijian-Base-(N)", "Kelp-Tunisian-Coast-(N)", "Moss-Lebanese-Sea-(N)", "Seaweed-Moroccan-(N)", "Oakmoss-Yugoslavian-(N)", "Vanilla-Tunisian-Base-(N)"],
            nostalgia: ["Almond (N)", "Coffee (N)", "Caramel (B)", "Chestnut Cream (N)", "Cocoa Powder (N)", "Cocoa-Venezuelan-Bean-(N)", "Coffee-Ethiopian-Roast-(N)", "Almond-Moroccan-Roasted-(N)", "Caramel-Salted-Breton-(B)", "Chestnut-Tuscan-Roast-(N)", "Cocoa-Brazilian-Bean-(N)", "Coffee-Colombian-Roast-(N)", "Caramel-French-Burnt-(B)", "Chestnut-French-Cream-(N)", "Cocoa-Colombian-Powder-(N)", "Almond-Tunisian-Roasted-(N)", "Coffee-Brazilian-Bean-(N)", "Caramel-Dutch-Stroop-(B)", "Chestnut-Spanish-Roast-(N)", "Cocoa-Peruvian-Powder-(N)", "Almond-Spanish-Roasted-(N)", "Coffee-Yemeni-Roast-(N)", "Caramel-Spanish-Dulce-(B)", "Chestnut-Italian-Cream-(N)", "Cocoa-Ghanaian-Powder-(N)", "Almond-Italian-Roasted-(N)", "Coffee-Kenyan-Bean-(N)", "Caramel-Argentinian-(B)", "Chestnut-Moroccan-Roast-(N)", "Cocoa-Madagascan-Powder-(N)"],
            curiosity: ["Cumin (N)", "Star Anise (N)", "Eucalyptus (N)", "Fenugreek (N)", "Coriander Seed (N)", "Cumin-Egyptian-Seed-(N)", "Anise-Turkish-Seed-(N)", "Eucalyptus-Australian-Blue-(N)", "Fenugreek-Indian-Seed-(N)", "Coriander-Moroccan-Seed-(N)", "Cumin-Tunisian-Seed-(N)", "Star-Anise-Vietnamese-(N)", "Eucalyptus-Tasmanian-(N)", "Fenugreek-Moroccan-(N)", "Coriander-Egyptian-Seed-(N)", "Cumin-Moroccan-Seed-(N)", "Star-Anise-Chinese-(N)", "Eucalyptus-Moroccan-(N)", "Fenugreek-Tunisian-(N)", "Coriander-Tunisian-Seed-(N)", "Cumin-Syrian-Seed-(N)", "Star-Anise-Moroccan-(N)", "Eucalyptus-Lebanese-(N)", "Fenugreek-Syrian-(N)", "Coriander-Syrian-Seed-(N)", "Cumin-Lebanese-Seed-(N)", "Star-Anise-Tunisian-(N)", "Eucalyptus-Tunisian-(N)", "Fenugreek-Egyptian-(N)", "Coriander-Lebanese-Seed-(N)"],
            calm: ["Lotus (N)", "Mint (N)", "White Musk (B)", "Water Hyacinth (N)", "Aloe Vera (N)", "Hyacinth-Water-Dutch-(N)", "Aloe-SouthAfrican-Gel-(N)", "Lotus-Thai-White-(N)", "Mint-Moroccan-Peppermint-(N)", "White-Musk-Mediterranean-(B)", "Water-Hyacinth-Vietnamese-(N)", "Aloe-Vera-Mexican-(N)", "Lotus-Indian-Blue-(N)", "Mint-Tunisian-Spearmint-(N)", "White-Musk-Atlantic-(B)", "Water-Hyacinth-Thai-(N)", "Aloe-Egyptian-Gel-(N)", "Lotus-Vietnamese-Pink-(N)", "Mint-Egyptian-Peppermint-(N)", "White-Musk-Pacific-(B)", "Water-Hyacinth-Moroccan-(N)", "Aloe-Vera-Tunisian-(N)", "Lotus-Syrian-White-(N)", "Mint-Syrian-Spearmint-(N)", "White-Musk-Caribbean-(B)", "Water-Hyacinth-Tunisian-(N)", "Aloe-Moroccan-Gel-(N)", "Lotus-Tunisian-Pink-(N)", "Mint-Lebanese-Peppermint-(N)", "White-Musk-Tunisian-(B)"],
            empathy: ["Peony (N)", "Lily of the Valley (N)", "Vanilla (N)", "Lilac (N)", "Honeycomb (N)", "Lilac-Syracuse-Bloom-(N)", "Honey-French-Lavender-(N)", "Peony-Chinese-Pink-(N)", "Lily-of-the-Valley-French-(N)", "Vanilla-Madagascan-Pod-(N)", "Peony-Japanese-White-(N)", "Lilac-French-Lavender-(N)", "Honey-Tunisian-Wild-(N)", "Lily-of-the-Valley-English-(N)", "Vanilla-Tahitian-Orchid-(N)", "Peony-Korean-Red-(N)", "Lilac-Moroccan-Purple-(N)", "Honey-Moroccan-Citrus-(N)", "Lily-of-the-Valley-Italian-(N)", "Vanilla-Comorian-Pod-(N)", "Peony-French-Blush-(N)", "Lilac-Tunisian-Bloom-(N)", "Honey-Turkish-Rose-(N)", "Lily-of-the-Valley-Spanish-(N)", "Vanilla-Papua-Orchid-(N)", "Peony-Tunisian-Pink-(N)", "Lilac-Egyptian-Purple-(N)", "Honey-Lebanese-Clover-(N)", "Lily-of-the-Valley-Greek-(N)", "Vanilla-Fijian-Orchid-(N)"],
            ambition: ["Cardamom (N)", "Ginger (N)", "Cedar (N)", "Cardamom Green (N)", "Turmeric (N)", "Cardamom-Guatemalan-Pod-(N)", "Turmeric-Indian-Root-(N)", "Ginger-Indian-Root-(N)", "Cedar-Virginian-Core-(N)", "Cardamom-Sri-Lankan-(N)", "Turmeric-Moroccan-Root-(N)", "Ginger-Zanzibar-Root-(N)", "Cedar-Moroccan-Bark-(N)", "Cardamom-Tunisian-(N)", "Turmeric-Sri-Lankan-(N)", "Ginger-Thai-Root-(N)", "Cedar-Texas-Core-(N)", "Cardamom-Moroccan-(N)", "Turmeric-Tunisian-Root-(N)", "Ginger-Vietnamese-Root-(N)", "Cedar-Himalayan-Core-(N)", "Cardamom-Lebanese-(N)", "Turmeric-Egyptian-(N)", "Ginger-Moroccan-Root-(N)", "Cedar-Moroccan-Core-(N)", "Cardamom-Egyptian-(N)", "Turmeric-Lebanese-Root-(N)", "Ginger-Sri-Lankan-Root-(N)", "Cedar-Syrian-Core-(N)", "Cardamom-Syrian-(N)"],
        },
        seasonalInfluence: {
            spring: { character: "fresh and blooming", intensity: "light" },
            summer: { character: "vibrant and energetic", intensity: "moderate" },
            autumn: { character: "warm and spicy", intensity: "rich" },
            winter: { character: "cozy and intense", intensity: "deep" }
        },
        questions: [
            {
                en: "If you could bottle one emotion, it would be...",
                ar: "إذا كان بإمكانك تعبئة عاطفة واحدة، فستكون...",
                options: [
                    ["Serene contentment", "رضا هادئ", ["elegant", "serenity", "oriental", "reflection"]],
                    ["Fierce confidence", "ثقة شرسة", ["bold", "confidence", "spicy", "celebration"]],
                    ["Deep intrigue", "فضول عميق", ["mysterious", "intrigue", "woody", "reflection"]],
                    ["Pure joy", "فرح خالص", ["refreshing", "joy", "citrus", "celebration"]],
                    ["Adventurous zeal", "حماس مغامر", ["playful", "excitement", "citrus", "travel"]],
                    ["Romantic nostalgia", "حنين رومانسي", ["sensual", "romance", "floral", "romance"]]
                ]
            },
            {
                en: "Your ideal evening setting is...",
                ar: "مكان أمسيتك المثالي هو...",
                options: [
                    ["Candlelit salon with soft music", "صالون مضاء بالشموع مع موسيقى هادئة", ["elegant", "serenity", "oriental", "romance"]],
                    ["Bold pop-art gallery with bright lights", "معرض فني بألوان زاهية وإضاءة ساطعة", ["bold", "confidence", "citrus", "celebration"]],
                    ["Secluded reading nook by the fireplace", "ركن قراءة منعزل بجوار المدفأة", ["mysterious", "reflection", "woody", "reflection"]],
                    ["Sunset beach bonfire", "نار شاطئ عند الغروب", ["refreshing", "joy", "aquatic", "celebration"]],
                    ["Rooftop party with city skyline", "حفلة على السطح مع أفق المدينة", ["playful", "excitement", "citrus", "celebration"]],
                    ["Cozy dinner under fairy lights", "عشاء مريح تحت الأضواء الخيالية", ["sensual", "romance", "floral", "romance"]]
                ]
            },
            {
                en: "Your favorite childhood memory involves...",
                ar: "ذكرى طفولتك المفضلة تتضمن...",
                options: [
                    ["Riding a carousel at a fair", "ركوب دائري في معرض", ["elegant", "romance", "floral", "childhood"]],
                    ["Building forts outdoors", "بناء الحصون في الخارج", ["bold", "excitement", "woody", "childhood"]],
                    ["Bedtime stories by lamplight", "قصص ما قبل النوم بضوء المصباح", ["mysterious", "serenity", "oriental", "childhood"]],
                    ["Splashing in summer puddles", "الرذاذ في برك الصيف", ["refreshing", "joy", "aquatic", "childhood"]],
                    ["Chasing kites in a field", "مطاردة الطائرات الورقية في حقل", ["playful", "excitement", "citrus", "childhood"]],
                    ["Baking cookies with family", "خبز الكعك مع العائلة", ["sensual", "nostalgia", "gourmand", "childhood"]]
                ]
            },
            {
                en: "Your dream landscape painting would feature...",
                ar: "لوحة المناظر الطبيعية التي تحلم بها ستحتوي على...",
                options: [
                    ["Stately manor’s rose garden", "حديقة الورود في قصر فخم", ["elegant", "romance", "floral", "romance"]],
                    ["Blazing sunset over desert dunes", "غروب مشتعل فوق كثبان الصحراء", ["bold", "passion", "spicy", "nature"]],
                    ["Moonlit forest with silvery mist", "غابة مضاءة بالقمر مع ضباب فضي", ["mysterious", "serenity", "woody", "nature"]],
                    ["Crashing waves on a sunny shore", "أمواج متلاطمة على شاطئ مشمس", ["refreshing", "joy", "aquatic", "nature"]],
                    ["Vibrant meadow with wildflowers", "مرج نابض بالحياة مع الزهور البرية", ["playful", "excitement", "citrus", "nature"]],
                    ["Twilight vineyard with rolling hills", "كرم في الغسق مع تلال متدحرجة", ["sensual", "romance", "floral", "romance"]]
                ]
            },
            {
                en: "Your go-to creative outlet is...",
                ar: "منفذك الإبداعي المفضل هو...",
                options: [
                    ["Calligraphy in cozy studio", "الخط في استوديو مريح", ["elegant", "serenity", "oriental", "reflection"]],
                    ["High-intensity workout", "تمرين عالي الكثافة", ["bold", "power", "spicy", "celebration"]],
                    ["Journaling by a window", "كتابة يوميات بجوار نافذة", ["mysterious", "reflection", "woody", "reflection"]],
                    ["Beach volleyball at dusk", "كرة طائرة شاطئية عند الغسق", ["refreshing", "joy", "aquatic", "celebration"]],
                    ["Street photography in a city", "تصوير الشوارع في مدينة", ["playful", "excitement", "citrus", "travel"]],
                    ["Cooking a gourmet meal", "طهي وجبة فاخرة", ["sensual", "romance", "gourmand", "celebration"]]
                ]
            },
            {
                en: "The book genre you’re drawn to is...",
                ar: "نوع الكتاب الذي يجذبك هو...",
                options: [
                    ["Classic romance", "رومانسية كلاسيكية", ["sensual", "romance", "floral", "romance"]],
                    ["Adventure thrillers", "روايات المغامرات المثيرة", ["bold", "excitement", "spicy", "travel"]],
                    ["Mysteries & gothic", "ألغاز وجوثيك", ["mysterious", "intrigue", "oriental", "reflection"]],
                    ["Feel-good coming-of-age", "قصص نمو مبهجة", ["refreshing", "joy", "citrus", "childhood"]],
                    ["Fantasy with vibrant worlds", "خيال مع عوالم نابضة", ["playful", "excitement", "citrus", "travel"]],
                    ["Poetry & introspective essays", "شعر ومقالات تأملية", ["elegant", "reflection", "woody", "reflection"]]
                ]
            },
            {
                en: "Your favorite film scene vibe is...",
                ar: "أجواء المشهد السينمائي المفضل لديك هي...",
                options: [
                    ["Intimate by candlelight", "حميم بضوء الشموع", ["sensual", "romance", "oriental", "romance"]],
                    ["Explosive action abroad", "أكشن متفجر في الخارج", ["bold", "power", "spicy", "travel"]],
                    ["Haunting close-ups", "لقطات مقربة مؤثرة", ["mysterious", "intrigue", "woody", "reflection"]],
                    ["Joyful dance in the rain", "رقصة مبهجة في المطر", ["refreshing", "joy", "aquatic", "celebration"]],
                    ["Colorful festival chase", "مطاردة مهرجان ملون", ["playful", "excitement", "citrus", "celebration"]],
                    ["Sweeping romantic vistas", "مناظر رومانسية شاملة", ["elegant", "romance", "floral", "romance"]]
                ]
            },
            {
                en: "Your signature accessory is...",
                ar: "إكسسوارك المميز هو...",
                options: [
                    ["Rose-gold locket", "قلادة ذهبية وردية", ["elegant", "romance", "floral", "romance"]],
                    ["Statement cuff", "سوار مميز", ["bold", "confidence", "spicy", "celebration"]],
                    ["Oxidized pendant", "قلادة مؤكسدة", ["mysterious", "intrigue", "woody", "reflection"]],
                    ["Woven friendship bracelet", "سوار صداقة منسوج", ["refreshing", "joy", "citrus", "childhood"]],
                    ["Bright beaded necklace", "قلادة ملونة بالخرز", ["playful", "excitement", "citrus", "celebration"]],
                    ["Velvet choker", "قلادة مخملية", ["sensual", "romance", "oriental", "romance"]]
                ]
            },
            {
                en: "Your favorite lighting ambiance is...",
                ar: "الإضاءة المفضلة لديك هي...",
                options: [
                    ["Soft candle glow", "توهج الشموع الناعم", ["sensual", "romance", "oriental", "romance"]],
                    ["Neon club strobes", "إضاءة نيون النوادي", ["bold", "excitement", "citrus", "celebration"]],
                    ["Moody lamps", "مصابيح ذات طابع كئيب", ["mysterious", "intrigue", "woody", "reflection"]],
                    ["Golden hour sunlight", "ضوء الشمس في الساعة الذهبية", ["refreshing", "joy", "citrus", "nature"]],
                    ["Twinkling fairy lights", "أضواء خيالية متلألئة", ["playful", "excitement", "citrus", "celebration"]],
                    ["Warm fireplace flicker", "وميض المدفأة الدافئ", ["elegant", "serenity", "woody", "reflection"]]
                ]
            },
            {
                en: "Your perfect weekend escape is...",
                ar: "هروب نهاية الأسبوع المثالي لديك هو...",
                options: [
                    ["Garden poetry", "شعر في الحديقة", ["sensual", "romance", "floral", "romance"]],
                    ["All-night party", "حفلة طوال الليل", ["bold", "excitement", "citrus", "celebration"]],
                    ["Secret lounge", "صالة سرية", ["mysterious", "intrigue", "woody", "reflection"]],
                    ["Coastal surf retreat", "ملاذ لركوب الأمواج الساحلي", ["refreshing", "joy", "aquatic", "travel"]],
                    ["Festival road trip", "رحلة مهرجان", ["playful", "excitement", "citrus", "travel"]],
                    ["Countryside manor stay", "إقامة في قصر ريفي", ["elegant", "serenity", "floral", "romance"]]
                ]
            },
            {
                en: "The emotion you chase most is...",
                ar: "العاطفة التي تسعى وراءها أكثر هي...",
                options: [
                    ["Serene contentment", "رضا هادئ", ["elegant", "serenity", "oriental", "reflection"]],
                    ["Fierce confidence", "ثقة شرسة", ["bold", "confidence", "spicy", "celebration"]],
                    ["Deep intrigue", "فضول عميق", ["mysterious", "intrigue", "woody", "reflection"]],
                    ["Pure joy", "فرح خالص", ["refreshing", "joy", "citrus", "celebration"]],
                    ["Adventurous zeal", "حماس مغامر", ["playful", "excitement", "citrus", "travel"]],
                    ["Romantic nostalgia", "حنين رومانسي", ["sensual", "romance", "floral", "romance"]]
                ]
            },
            {
                en: "Your ideal meal presentation is...",
                ar: "تقديم وجبتك المثالي هو...",
                options: [
                    ["Artful plating", "تقديم فني", ["elegant", "serenity", "oriental", "reflection"]],
                    ["Spicy bold flavors", "نكهات جريئة حارة", ["bold", "passion", "spicy", "celebration"]],
                    ["Rich slow-cooked stews", "يخنات مطهية ببطء غنية", ["sensual", "gourmand", "woody", "childhood"]],
                    ["Fresh coastal ceviche", "سيفيتشي ساحلي طازج", ["refreshing", "joy", "aquatic", "nature"]],
                    ["Colorful street food", "طعام شوارع ملون", ["playful", "excitement", "citrus", "travel"]],
                    ["Rustic family-style", "أسلوب عائلي ريفي", ["elegant", "nostalgia", "gourmand", "childhood"]]
                ]
            },
            {
                en: "Your approach to challenges is...",
                ar: "نهجك في مواجهة التحديات هو...",
                options: [
                    ["Heartwarming & sincere", "مؤثر وصادق", ["sensual", "joy", "floral", "romance"]],
                    ["Challenging & ambitious", "تحدي وطموح", ["bold", "confidence", "spicy", "celebration"]],
                    ["Mysterious & speculative", "غامض وتأملي", ["mysterious", "intrigue", "oriental", "reflection"]],
                    ["Optimistic & adaptive", "متفائل وقابل للتكيف", ["refreshing", "joy", "citrus", "celebration"]],
                    ["Playful & unconventional", "مرح وغير تقليدي", ["playful", "excitement", "citrus", "celebration"]],
                    ["Calm & strategic", "هادئ واستراتيجي", ["elegant", "serenity", "woody", "reflection"]]
                ]
            },
            {
                en: "Your favorite music to unwind is...",
                ar: "موسيقاك المفضلة للاسترخاء هي...",
                options: [
                    ["Soft piano nocturne", "نوكتيرن بيانو ناعم", ["elegant", "serenity", "woody", "reflection"]],
                    ["Driving rock anthem", "نشيد روك قوي", ["bold", "passion", "spicy", "celebration"]],
                    ["Eerie ambient track", "موسيقى طيفية غريبة", ["mysterious", "intrigue", "oriental", "reflection"]],
                    ["Upbeat acoustic pop", "بوب أكوستيك مبهج", ["refreshing", "joy", "citrus", "celebration"]],
                    ["Eclectic world beats", "إيقاعات عالمية متنوعة", ["playful", "excitement", "citrus", "travel"]],
                    ["Soulful jazz melodies", "ألحان جاز مؤثرة", ["sensual", "romance", "floral", "romance"]]
                ]
            },
            {
                en: "Your dream home aesthetic is...",
                ar: "جمالية منزل أحلامك هي...",
                options: [
                    ["Luxurious spa resort", "منتجع سبا فاخر", ["elegant", "romance", "oriental", "romance"]],
                    ["Chic urban loft", "لوفت حضري أنيق", ["bold", "confidence", "citrus", "celebration"]],
                    ["Hidden historic villa", "فيلا تاريخية مخفية", ["mysterious", "intrigue", "oriental", "reflection"]],
                    ["Bright seaside cottage", "كوخ ساحلي مشرق", ["refreshing", "joy", "aquatic", "nature"]],
                    ["Colorful bohemian flat", "شقة بوهيمية ملونة", ["playful", "excitement", "floral", "celebration"]],
                    ["Rustic vineyard estate", "عزبة كرم ريفية", ["sensual", "romance", "floral", "romance"]]
                ]
            },
            {
                en: "Your ideal hobby involves...",
                ar: "هوايتك المثالية تتضمن...",
                options: [
                    ["Painting or sketching", "الرسم أو التخطيط", ["elegant", "reflection", "floral", "reflection"]],
                    ["Competitive sports", "رياضات تنافسية", ["bold", "power", "spicy", "celebration"]],
                    ["Creative writing", "كتابة إبداعية", ["mysterious", "intrigue", "oriental", "reflection"]],
                    ["Surfing or hiking", "ركوب الأمواج أو التنزه", ["refreshing", "joy", "aquatic", "nature"]],
                    ["Dance or music jam", "رقص أو جلسة موسيقية", ["playful", "excitement", "citrus", "celebration"]],
                    ["Gardening or cooking", "البستنة أو الطهي", ["sensual", "romance", "gourmand", "nature"]]
                ]
            },
            {
                en: "At a social gathering, you’re most likely...",
                ar: "في تجمع اجتماعي، من المرجح أن تكون...",
                options: [
                    ["In a quiet corner chatting", "في ركن هادئ تتحدث", ["elegant", "reflection", "oriental", "reflection"]],
                    ["Leading the dance floor", "تقود حلبة الرقص", ["bold", "passion", "spicy", "celebration"]],
                    ["Observing from shadows", "تراقب من الظلال", ["mysterious", "intrigue", "woody", "reflection"]],
                    ["Sharing funny stories", "تشارك قصصًا مضحكة", ["refreshing", "joy", "citrus", "celebration"]],
                    ["Starting a group game", "تبدأ لعبة جماعية", ["playful", "excitement", "citrus", "celebration"]],
                    ["Hosting with warmth", "تستضيف بدفء", ["sensual", "romance", "floral", "celebration"]]
                ]
            },
            {
                en: "Your dream travel destination is...",
                ar: "وجهة سفر أحلامك هي...",
                options: [
                    ["Historic mansion stay", "إقامة في قصر تاريخي", ["elegant", "romance", "floral", "romance"]],
                    ["Multi-city tour", "جولة متعددة المدن", ["bold", "confidence", "citrus", "travel"]],
                    ["Stay in ancient citadel", "إقامة في قلعة قديمة", ["mysterious", "intrigue", "oriental", "reflection"]],
                    ["Tropical island getaway", "ملاذ جزيرة استوائية", ["refreshing", "joy", "aquatic", "travel"]],
                    ["Backpacking festival circuit", "جولة مهرجانات بالحقيبة", ["playful", "excitement", "citrus", "travel"]],
                    ["Vineyard wine tour", "جولة نبيذ في الكروم", ["sensual", "romance", "floral", "travel"]]
                ]
            },
            {
                en: "Your favorite fabric texture is...",
                ar: "نسيج القماش المفضل لديك هو...",
                options: [
                    ["Silky satin", "ساتان حريري", ["sensual", "romance", "oriental", "romance"]],
                    ["Embossed leather", "جلد منقوش", ["bold", "power", "spicy", "celebration"]],
                    ["Raw velvet", "مخمل خام", ["mysterious", "intrigue", "woody", "reflection"]],
                    ["Crisp cotton", "قطن ناصع", ["refreshing", "joy", "citrus", "nature"]],
                    ["Colorful linen", "كتان ملون", ["playful", "excitement", "citrus", "nature"]],
                    ["Soft cashmere", "كشمير ناعم", ["elegant", "serenity", "floral", "romance"]]
                ]
            },
            {
                en: "The memory you’d bottle is...",
                ar: "الذكرى التي ستعبئها هي...",
                options: [
                    ["First meaningful conversation", "أول محادثة ذات معنى", ["elegant", "romance", "oriental", "reflection"]],
                    ["A triumphant achievement", "إنجاز عظيم", ["bold", "confidence", "spicy", "celebration"]],
                    ["A secret you never shared", "سر لم تشاركه أبدًا", ["mysterious", "intrigue", "woody", "reflection"]],
                    ["Carefree summer day", "يوم صيفي خالٍ من الهموم", ["refreshing", "joy", "citrus", "childhood"]],
                    ["Festival under the stars", "مهرجان تحت النجوم", ["playful", "excitement", "citrus", "celebration"]],
                    ["Falling in love", "الوقوع في الحب", ["sensual", "romance", "floral", "romance"]]
                ]
            }
        ],
        optionWeights: [1.5, 1.3, 1.2, 1.2, 1.1, 1.1, 1.1, 1.1, 1.0, 1.0, 1.5, 1.0, 1.0, 1.1, 1.0, 1.0, 1.2, 1.0, 1.0, 1.0],
        updateTranslations: function() {
            try {
                const lang = this.currentLang;
                document.getElementById('subtitle').textContent = this.translations[lang].discoverScent;
                document.getElementById('startQuizBtn').textContent = this.translations[lang].startQuiz;
                document.getElementById('prevBtn').textContent = this.translations[lang].prev;
                document.getElementById('nextBtn').textContent = this.translations[lang].next;
                document.getElementById('resultSubtitle').textContent = this.translations[lang].resultSubtitle;
                document.getElementById('langToggle').textContent = this.translations[lang][lang === 'en' ? 'arabic' : 'english'];

                const introTextElements = document.querySelectorAll('.intro-text');
                introTextElements.forEach(element => {
                    element.style.display = element.getAttribute('data-lang') === lang ? 'block' : 'none';
                });

                if (this.currentQuestion < this.questions.length) {
                    this.displayQuestion();
                }
            } catch (error) {
                console.error('Failed to update translations:', error);
            }
        },
        toggleLanguage: function() {
            try {
                this.currentLang = this.currentLang === 'en' ? 'ar' : 'en';
                document.body.style.direction = this.currentLang === 'ar' ? 'rtl' : 'ltr';
                this.updateTranslations();
            } catch (error) {
                console.error('Failed to toggle language:', error);
            }
        },
        init: function() {
            try {
                console.log('Initializing PerfumeGenerator...');
                for (let category in this.categories) {
                    this.categories[category].forEach(item => {
                        this.score[category][item] = 0;
                    });
                }
                const startQuizBtn = document.getElementById('startQuizBtn');
                const langToggle = document.getElementById('langToggle');
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                const optionsContainer = document.getElementById('optionsContainer');
                const shareResultsBtn = document.getElementById('shareResultsBtn');

                if (!startQuizBtn || !langToggle || !prevBtn || !nextBtn || !optionsContainer || !shareResultsBtn) {
                    throw new Error('Required DOM elements not found');
                }

                startQuizBtn.addEventListener('click', () => this.startQuiz());
                langToggle.addEventListener('click', () => this.toggleLanguage());
                prevBtn.addEventListener('click', () => this.prevQuestion());
                nextBtn.addEventListener('click', () => this.nextQuestion());
                shareResultsBtn.addEventListener('click', () => this.shareResults());

                optionsContainer.addEventListener('click', (e) => {
                    const optionCard = e.target.closest('.option-card');
                    if (optionCard) {
                        this.selectOption(optionCard);
                    }
                });

                optionsContainer.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        const optionCard = e.target.closest('.option-card');
                        if (optionCard) {
                            e.preventDefault();
                            this.selectOption(optionCard);
                        }
                    }
                });

                document.getElementById('birthDateInput').value = '';
                document.getElementById('ingredientPref').value = 'both';
                this.updateTranslations();
            } catch (error) {
                console.error('Initialization failed:', error);
            }
        },
        startQuiz: function() {
            try {
                console.log('Starting quiz...');
                const birthDateInput = document.getElementById('birthDateInput').value;
                if (!birthDateInput) {
                    alert(this.currentLang === 'en' ? 'Please enter your birth date.' : 'يرجى إدخال تاريخ ميلادك.');
                    return;
                }
                document.querySelector('.header').style.display = 'none';
                document.querySelector('.quiz-section').style.display = 'block';
                this.currentQuestion = 0;
                this.displayQuestion();
            } catch (error) {
                console.error('Failed to start quiz:', error);
            }
        },
        displayQuestion: function() {
            try {
                console.log(`Displaying question ${this.currentQuestion + 1}...`);
                const question = this.questions[this.currentQuestion];
                const lang = this.currentLang;

                document.getElementById('questionText').textContent = question[lang];
                document.getElementById('currentQ').textContent = this.currentQuestion + 1;
                document.getElementById('totalQ').textContent = this.questions.length;

                const optionsContainer = document.getElementById('optionsContainer');
                optionsContainer.innerHTML = '';

                question.options.forEach(([textEn, textAr, traits], index) => {
                    const optionCard = document.createElement('div');
                    optionCard.className = 'option-card';
                    optionCard.tabIndex = 0;
                    optionCard.setAttribute('data-option-index', index);

                    const optionText = document.createElement('p');
                    optionText.className = 'option-text';
                    optionText.textContent = lang === 'en' ? textEn : textAr;
                    optionCard.appendChild(optionText);

                    if (this.answers[this.currentQuestion] === index) {
                        optionCard.classList.add('selected');
                    }

                    optionsContainer.appendChild(optionCard);
                });

                const progressPercent = ((this.currentQuestion + 1) / this.questions.length) * 100;
                document.getElementById('progressFill').style.width = `${progressPercent}%`;

                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                prevBtn.disabled = this.currentQuestion === 0;
                nextBtn.disabled = this.answers[this.currentQuestion] === undefined;

                document.querySelectorAll('.option-card').forEach(card => {
                    card.addEventListener('focus', () => {
                        card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    });
                });
            } catch (error) {
                console.error('Failed to display question:', error);
            }
        },
        selectOption: function(optionCard) {
            try {
                console.log(`Selecting option for question ${this.currentQuestion + 1}...`);
                const optionIndex = parseInt(optionCard.getAttribute('data-option-index'));
                const prevSelected = document.querySelector('.option-card.selected');

                if (prevSelected) {
                    prevSelected.classList.remove('selected');
                }

                optionCard.classList.add('selected');

                if (!this.startTime) {
                    this.startTime = Date.now();
                }

                const endTime = Date.now();
                this.responseTimes[this.currentQuestion] = {
                    start: this.startTime,
                    end: endTime,
                    duration: endTime - this.startTime
                };
                this.startTime = endTime;

                this.answers[this.currentQuestion] = optionIndex;
                document.getElementById('nextBtn').disabled = false;

                const [, , traits] = this.questions[this.currentQuestion].options[optionIndex];
                const weight = this.optionWeights[this.currentQuestion] || 1;
                traits.forEach(trait => {
                    const category = Object.keys(this.categories).find(cat => this.categories[cat].includes(trait));
                    if (category) {
                        this.score[category][trait] = (this.score[category][trait] || 0) + weight;
                    }
                });
            } catch (error) {
                console.error('Failed to select option:', error);
            }
        },
        prevQuestion: function() {
            try {
                console.log(`Navigating to previous question ${this.currentQuestion}...`);
                if (this.currentQuestion > 0) {
                    this.currentQuestion--;
                    this.displayQuestion();
                }
            } catch (error) {
                console.error('Failed to navigate to previous question:', error);
            }
        },
        nextQuestion: function() {
            try {
                console.log(`Navigating to next question ${this.currentQuestion + 2}...`);
                if (this.answers[this.currentQuestion] !== undefined) {
                    this.currentQuestion++;
                    if (this.currentQuestion < this.questions.length) {
                        this.displayQuestion();
                    } else {
                        this.showResult();
                    }
                }
            } catch (error) {
                console.error('Failed to navigate to next question:', error);
            }
        },
        getSeason: function(birthDate) {
            try {
                const date = new Date(birthDate);
                const month = date.getMonth() + 1;
                if (month >= 3 && month <= 5) return 'spring';
                if (month >= 6 && month <= 8) return 'summer';
                if (month >= 9 && month <= 11) return 'autumn';
                return 'winter';
            } catch (error) {
                console.error('Failed to determine season:', error);
                return 'winter';
            }
        },
        getTopCategories: function() {
            try {
                console.log('Calculating top categories...');
                const topCategories = {};
                for (let category in this.score) {
                    let maxScore = 0;
                    let secondMaxScore = 0;
                    let maxItem = '';
                    let secondMaxItem = '';
                    for (let item in this.score[category]) {
                        const score = this.score[category][item];
                        if (score > maxScore) {
                            secondMaxScore = maxScore;
                            secondMaxItem = maxItem;
                            maxScore = score;
                            maxItem = item;
                        } else if (score > secondMaxScore) {
                            secondMaxScore = score;
                            secondMaxItem = item;
                        }
                    }
                    topCategories[category] = { primary: maxItem, secondary: secondMaxItem };
                }
                return topCategories;
            } catch (error) {
                console.error('Failed to get top categories:', error);
                return {};
            }
        },
        getPerfumeBlend: function(dominantFamily, topCategories, ingredientPref) {
            try {
                console.log(`Generating perfume blend for family: ${dominantFamily}, pref: ${ingredientPref}`);
                let blend = { top: [], heart: [], base: [] };
                const familyNotes = this.pyramidNotes[dominantFamily];

                if (!familyNotes || !familyNotes[0] || !familyNotes[1] || !familyNotes[2]) {
                    throw new Error('Invalid family notes structure');
                }

                const filterNotes = (notesArray) => {
                    if (ingredientPref === 'natural') {
                        return notesArray.filter(note => note.endsWith('(N)'));
                    } else if (ingredientPref === 'synthetic') {
                        return notesArray.filter(note => note.endsWith('(B)') || note.endsWith('(S)'));
                    }
                    return notesArray;
                };

                const selectNotes = (notes, count, layer, selectedFamilies) => {
                    let availableNotes = filterNotes(notes);
                    if (availableNotes.length < count) {
                        console.warn(`Insufficient notes for ${layer}, available: ${availableNotes.length}`);
                        availableNotes = availableNotes.concat(notes);
                    }
                    let selectedNotes = [];
                    const getNoteFamily = (note) => {
                        let base = note.replace(/\s*\(.*\)$/g, '').trim().toLowerCase();
                        base = base.split(/[- ]/)[0];
                        if (base.startsWith('ambrox')) return 'ambrox'; // Normalize ambrox variants
                        return base;
                    };
                    const primaryStyle = topCategories.style.primary;
                    const primaryEmotion = topCategories.emotion.primary;
                    const secondaryStyle = topCategories.style.secondary;
                    const secondaryEmotion = topCategories.emotion.secondary;

                    const traitNotes = [
                        ...(this.traitToNoteMap[primaryStyle] || []),
                        ...(this.traitToNoteMap[primaryEmotion] || []),
                        ...(this.traitToNoteMap[secondaryStyle] || []),
                        ...(this.traitToNoteMap[secondaryEmotion] || [])
                    ].filter(note => availableNotes.includes(note));

                    console.log(`Trait notes for ${layer}:`, traitNotes);

                    for (let i = traitNotes.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [traitNotes[i], traitNotes[j]] = [traitNotes[j], traitNotes[i]];
                    }

                    for (let i = 0; i < count && traitNotes.length > 0; i++) {
                        const note = traitNotes.shift();
                        const noteFamily = getNoteFamily(note);
                        if (!selectedFamilies.has(noteFamily)) {
                            selectedNotes.push(note);
                            selectedFamilies.add(noteFamily);
                            availableNotes = availableNotes.filter(n => n !== note);
                            console.log(`Selected ${note} for ${layer}, family: ${noteFamily}`);
                        }
                    }

                    while (selectedNotes.length < count && availableNotes.length > 0) {
                        const noteIndex = Math.floor(Math.random() * availableNotes.length);
                        const note = availableNotes[noteIndex];
                        const noteFamily = getNoteFamily(note);
                        if (!selectedFamilies.has(noteFamily)) {
                            selectedNotes.push(note);
                            selectedFamilies.add(noteFamily);
                            availableNotes.splice(noteIndex, 1);
                            console.log(`Fallback selected ${note} for ${layer}, family: ${noteFamily}`);
                        } else {
                            availableNotes.splice(noteIndex, 1);
                        }
                    }

                    console.log(`Selected families after ${layer}:`, Array.from(selectedFamilies));

                    if (selectedNotes.length < count) {
                        console.warn(`Only selected ${selectedNotes.length} notes for ${layer}`);
                    }
                    return selectedNotes;
                };

                const topTraits = ['bold', 'joy', 'excitement', 'playful', 'refreshing', 'curiosity'];
                const heartTraits = ['elegant', 'romance', 'serenity', 'sensual', 'empathy', 'intrigue'];
                const baseTraits = ['mysterious', 'reflection', 'melancholy', 'power', 'nostalgia', 'confidence', 'ambition'];

                let topScore = topTraits.reduce((sum, trait) => sum + (this.score.style[trait] || 0) + (this.score.emotion[trait] || 0), 0);
                let heartScore = heartTraits.reduce((sum, trait) => sum + (this.score.style[trait] || 0) + (this.score.emotion[trait] || 0), 0);
                let baseScore = baseTraits.reduce((sum, trait) => sum + (this.score.style[trait] || 0) + (this.score.emotion[trait] || 0), 0);
                const totalScore = topScore + heartScore + baseScore || 1;

                const topWeight = topScore / totalScore;
                const heartWeight = heartScore / totalScore;
                const baseWeight = baseScore / totalScore;

                const styleScores = Object.values(this.score.style).filter(score => score !== undefined);
                const emotionScores = Object.values(this.score.emotion).filter(score => score !== undefined);
                const variance = (arr) => {
                    if (!arr.length) return 0;
                    const mean = arr.reduce((a, b) => a + b, 0) / arr.length;
                    return Math.sqrt(arr.reduce((sum, x) => sum + Math.pow(x - mean, 2), 0) / arr.length);
                };
                const totalNotes = variance([...styleScores, ...emotionScores]) > 1.8 ? 12 : 9;

                console.log(`Scores: Top ${topScore}, Heart ${heartScore}, Base ${baseScore}`);
                console.log(`Weights: Top ${topWeight.toFixed(3)}, Heart ${heartWeight.toFixed(3)}, Base ${baseWeight.toFixed(3)}`);
                console.log(`Variance: ${variance([...styleScores, ...emotionScores]).toFixed(3)}`);
                
                let topCount = Math.max(2, Math.min(5, Math.round(topWeight * totalNotes)));
                let heartCount = Math.max(2, Math.min(5, Math.round(heartWeight * totalNotes)));
                let baseCount = Math.max(2, Math.min(5, Math.round(baseWeight * totalNotes)));

                console.log(`Initial Counts: Top ${topCount}, Heart ${heartCount}, Base ${baseCount}`);

                let currentTotal = topCount + heartCount + baseCount;
                const selectedFamilies = new Set();
                while (currentTotal !== totalNotes) {
                    if (currentTotal < totalNotes) {
                        if (topCount < 3) topCount++;
                        else if (baseCount < 5) baseCount++;
                        else if (heartCount < 3) heartCount++;
                    } else {
                        if (heartCount > 3 && heartWeight < baseWeight) heartCount--;
                        else if (baseCount > 5) baseCount--;
                        else if (topCount > 3) topCount--;
                    }
                    currentTotal = topCount + heartCount + baseCount;
                }

                console.log(`Final Counts: Top ${topCount}, Heart ${heartCount}, Base ${baseCount}`);

                blend.top = selectNotes(familyNotes[0], topCount, 'top', selectedFamilies);
                blend.heart = selectNotes(familyNotes[1], heartCount, 'heart', selectedFamilies);
                blend.base = selectNotes(familyNotes[2], baseCount, 'base', selectedFamilies);

                console.log(`Blend allocation: ${topCount} top, ${heartCount} heart, ${baseCount} base`);
                console.log('Generated blend:', blend);
                return blend;
            } catch (error) {
                console.error('Failed to generate perfume blend:', error);
                return { top: [], heart: [], base: [] };
            }
        },
        calculateConfidence: function() {
            try {
                console.log('Calculating confidence score...');
                const totalResponses = this.answers.filter(a => a !== undefined).length;
                let consistencyScore = 0;
                let coherenceScore = 0;
                let responseTimeScore = 0;

                for (let category in this.score) {
                    const scores = Object.values(this.score[category]);
                    const maxScore = Math.max(...scores);
                    const secondMaxScore = scores.sort((a, b) => b - a)[1] || 0;
                    console.log(`Category ${category}: Max ${maxScore}, Second Max ${secondMaxScore}`);
                    if (maxScore > 0) {
                        consistencyScore += (maxScore - secondMaxScore) / maxScore;
                    }
                }
                consistencyScore /= Object.keys(this.score).length;

                const style = this.getTopCategories().style.primary;
                const family = this.getTopCategories().family.primary;
                const validPairs = {
                    elegant: ['oriental', 'floral'], bold: ['spicy', 'citrus'], mysterious: ['woody', 'oriental'],
                    refreshing: ['citrus', 'aquatic'], playful: ['citrus', 'gourmand'], sensual: ['floral', 'oriental'],
                    exotic: ['spicy', 'oriental'], minimalist: ['aquatic', 'woody'], adventurous: ['spicy', 'woody'],
                    classic: ['floral', 'oriental'], bohemian: ['floral', 'gourmand'], modern: ['citrus', 'aquatic']
                };
                coherenceScore = validPairs[style].includes(family) ? 1 : 0.5;

                const durations = this.responseTimes.map(t => t?.duration || 0).filter(d => d > 0);
                const avgDuration = durations.length ? durations.reduce((a, b) => a + b, 0) / durations.length : 0;
                responseTimeScore = durations.every(d => d >= 1000 && d <= 30000) ? 1 : 0.8;

                console.log(`Consistency: ${consistencyScore.toFixed(3)}, Coherence: ${coherenceScore.toFixed(3)}, Response Time: ${responseTimeScore.toFixed(3)}`);
                console.log(`Durations: ${durations.map(d => (d/1000).toFixed(1)).join('s, ')}s, Avg: ${(avgDuration/1000).toFixed(1)}s`);

                const baseConfidence = consistencyScore * 0.4 + coherenceScore * 0.3 + responseTimeScore * 0.3;
                const responseCompleteness = (totalResponses / this.questions.length);
                const finalConfidence = Math.min(99, (baseConfidence * 0.8 + responseCompleteness * 0.2) * 100);
                console.log(`Final Confidence: ${finalConfidence.toFixed(1)}%`);
                return finalConfidence;
            } catch (error) {
                console.error('Failed to calculate confidence:', error);
                return 50;
            }
        },
        generateResultText: function(result) {
            return `
                Al Nada Fragrance Personality Quiz Results\n
                Personality Analysis: ${result.personalityAnalysis}\n
                Top Notes: ${result.topNotes.join(', ')}\n
                Heart Notes: ${result.heartNotes.join(', ')}\n
                Base Notes: ${result.baseNotes.join(', ')}\n
                Confidence Score: ${result.confidence}%\n
                Dominant Family: ${result.dominantFamily}\n
                Primary Style: ${result.primaryStyle}\n
                Secondary Style: ${result.secondaryStyle}\n
                Primary Emotion: ${result.primaryEmotion}\n
                Secondary Emotion: ${result.secondaryEmotion}\n
                Primary Memory: ${result.primaryMemory}\n
                Seasonal Influence: ${result.seasonalInfluence.character} (${result.seasonalInfluence.intensity})
            `;
        },
        generateCSV: function(result) {
            return [
                ['Field', 'Value'],
                ['Personality Analysis', result.personalityAnalysis],
                ['Top Notes', result.topNotes.join(';')],
                ['Heart Notes', result.heartNotes.join(';')],
                ['Base Notes', result.baseNotes.join(';')],
                ['Confidence Score', `${result.confidence}%`],
                ['Dominant Family', result.dominantFamily],
                ['Primary Style', result.primaryStyle],
                ['Secondary Style', result.secondaryStyle],
                ['Primary Emotion', result.primaryEmotion],
                ['Secondary Emotion', result.secondaryEmotion],
                ['Primary Memory', result.primaryMemory],
                ['Seasonal Influence', `${result.seasonalInfluence.character} (${result.seasonalInfluence.intensity})`]
            ].map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');
        },
        generatePDF: function(text) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.setFontSize(12);
            doc.text(text, 10, 10, { maxWidth: 190 });
            return doc.output('blob');
        },
        shareResults: function() {
            try {
                console.log('Sharing results...');
                const result = this.generateResult();
                if (!result) {
                    throw new Error('Result generation failed');
                }

                const resultText = this.generateResultText(result);
                const csvContent = this.generateCSV(result);

                const pdfBlob = this.generatePDF(resultText);
                const pdfFile = new File([pdfBlob], 'quiz_results.pdf', { type: 'application/pdf' });
                const csvBlob = new Blob([csvContent], { type: 'text/csv' });
                const csvFile = new File([csvBlob], 'quiz_results.csv', { type: 'text/csv' });

                const subject = encodeURIComponent('Al Nada Quiz Results');
                const body = encodeURIComponent('Please find my quiz results attached for consultation with the Perfume Nose Expert.\n\n' + resultText);
                const mailtoLink = `mailto:salyafei@gmail.com?subject=${subject}&body=${body}`;

                const files = [pdfFile, csvFile];
                if (navigator.msSaveOrOpenBlob || window.showSaveFilePicker) {
                    files.forEach(file => {
                        if (navigator.msSaveOrOpenBlob) {
                            navigator.msSaveOrOpenBlob(file, file.name);
                        } else {
                            window.showSaveFilePicker({
                                suggestedName: file.name
                            }).then(handle => handle.createWritable().then(writable => writable.write(file).then(() => writable.close())));
                        }
                    });
                } else {
                    console.warn('File saving not fully supported; prompting user to save manually.');
                }

                window.location.href = mailtoLink;
            } catch (error) {
                console.error('Failed to share results:', error);
                alert('Error sharing results. Please try again.');
            }
        },
        generateResult: function() {
            try {
                console.log('Generating result...');
                const topCategories = this.getTopCategories();
                const dominantFamily = topCategories.family.primary;
                const ingredientPref = document.getElementById('ingredientPref').value;
                const birthDate = document.getElementById('birthDateInput').value;
                const season = this.getSeason(birthDate);

                const blend = this.getPerfumeBlend(dominantFamily, topCategories, ingredientPref);
                const confidence = this.calculateConfidence();

                const lang = this.currentLang;
                const primaryStyle = topCategories.style.primary;
                const secondaryStyle = topCategories.style.secondary;
                const primaryEmotion = topCategories.emotion.primary;
                const secondaryEmotion = topCategories.emotion.secondary;
                const primaryMemory = topCategories.memory.primary;

                const personalityTemplates = {
                    en: {
                        elegant: "a refined and graceful presence",
                        bold: "a daring and vibrant energy",
                        mysterious: "an enigmatic and introspective aura",
                        refreshing: "a lively and uplifting spirit",
                        playful: "a joyful and carefree vibe",
                        sensual: "a passionate and alluring charm",
                        exotic: "an adventurous and unique essence",
                        minimalist: "a clean and serene simplicity",
                        adventurous: "a bold and exploratory nature",
                        classic: "a timeless and sophisticated charm",
                        bohemian: "a free-spirited and artistic soul",
                        modern: "a sleek and contemporary edge"
                    },
                    ar: {
                        elegant: "حضور راقٍ وأنيق",
                        bold: "طاقة جريئة ونابضة بالحياة",
                        mysterious: "هالة غامضة وتأملية",
                        refreshing: "روح مفعمة بالحيوية والانتعاش",
                        playful: "أجواء مرحة وخالية من الهموم",
                        sensual: "سحر عاطفي وجذاب",
                        exotic: "جوهر مغامر وفريد",
                        minimalist: "بساطة هادئة ونقية",
                        adventurous: "طباع جريئة واستكشافية",
                        classic: "سحر خالد ومتطور",
                        bohemian: "روح حرة وفنية",
                        modern: "طابع أنيق وعصري"
                    }
                };

                const emotionTemplates = {
                    en: {
                        serenity: "calm and peaceful",
                        confidence: "assured and empowered",
                        intrigue: "curious and enigmatic",
                        joy: "cheerful and radiant",
                        excitement: "energetic and thrilling",
                        romance: "romantic and tender",
                        reflection: "thoughtful and introspective",
                        passion: "fiery and intense",
                        power: "strong and commanding",
                        melancholy: "poignant and wistful",
                        nostalgia: "sentimental and warm",
                        curiosity: "inquisitive and adventurous",
                        calm: "tranquil and soothing",
                        empathy: "compassionate and heartfelt",
                        ambition: "driven and purposeful"
                    },
                    ar: {
                        serenity: "هادئ وسلمي",
                        confidence: "واثق ومتمكن",
                        intrigue: "فضولي وغامض",
                        joy: "مبهج ومشرق",
                        excitement: "نشيط ومثير",
                        romance: "رومانسي وعطوف",
                        reflection: "تأملي وعاكس",
                        passion: "ناري وشديد",
                        power: "قوي ومسيطر",
                        melancholy: "مؤثر وحزين",
                        nostalgia: "حنين ودافئ",
                        curiosity: "فضولي ومغامر",
                        calm: "هادئ ومريح",
                        empathy: "متعاطف ومؤثر",
                        ambition: "طموح وهادف"
                    }
                };

                const familyTemplates = {
                    en: {
                        oriental: "rich and opulent",
                        spicy: "warm and bold",
                        woody: "earthy and deep",
                        citrus: "bright and zesty",
                        floral: "lush and romantic",
                        gourmand: "sweet and indulgent",
                        aquatic: "fresh and serene"
                    },
                    ar: {
                        oriental: "غني وفاخر",
                        spicy: "دافئ وجريء",
                        woody: "ترابي وعمق",
                        citrus: "مشرق ومنعش",
                        floral: "فخم ورومانسي",
                        gourmand: "حلو وممتع",
                        aquatic: "منعش وهادئ"
                    }
                };

                const personalityAnalysis = lang === 'en' ?
                    `Your fragrance profile reveals ${personalityTemplates.en[primaryStyle]} with undertones of ${personalityTemplates.en[secondaryStyle]}. You embody the ${emotionTemplates.en[primaryEmotion]} spirit, often seeking moments of ${emotionTemplates.en[secondaryEmotion]}. Your scent leans toward a ${familyTemplates.en[dominantFamily]} essence, capturing your unique personality.` :
                    `ملف عطرك يكشف عن ${personalityTemplates.ar[primaryStyle]} مع لمسات من ${personalityTemplates.ar[secondaryStyle]}. أنت تجسد روح ${emotionTemplates.ar[primaryEmotion]}، وغالبًا ما تسعى للحظات من ${emotionTemplates.ar[secondaryEmotion]}. عطرك يميل نحو جوهر ${familyTemplates.ar[dominantFamily]}، يعكس شخصيتك الفريدة.`;

                return {
                    personalityAnalysis,
                    topNotes: blend.top,
                    heartNotes: blend.heart,
                    baseNotes: blend.base,
                    confidence: confidence.toFixed(1),
                    dominantFamily,
                    primaryStyle,
                    secondaryStyle,
                    primaryEmotion,
                    secondaryEmotion,
                    primaryMemory,
                    seasonalInfluence: this.seasonalInfluence[season]
                };
            } catch (error) {
                console.error('Failed to generate result:', error);
                return null;
            }
        },
        showResult: function() {
            try {
                console.log('Showing result...');
                document.querySelector('.quiz-section').style.display = 'none';
                const resultSection = document.querySelector('.result-section');
                resultSection.style.display = 'block';

                const result = this.generateResult();
                if (!result) {
                    throw new Error('Result generation failed');
                }

                document.getElementById('personalityAnalysis').textContent = result.personalityAnalysis;

                const fragranceComposition = document.getElementById('fragranceComposition');
                fragranceComposition.innerHTML = '';

                const createNoteCategory = (title, notes) => {
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'note-category';

                    const titleEl = document.createElement('h3');
                    titleEl.textContent = title;
                    categoryDiv.appendChild(titleEl);

                    const noteList = document.createElement('p');
                    noteList.className = 'note-list';
                    noteList.textContent = notes.join(', ');
                    categoryDiv.appendChild(noteList);

                    return categoryDiv;
                };

                fragranceComposition.appendChild(createNoteCategory(this.currentLang === 'en' ? 'Top Notes' : 'النوتات العليا', result.topNotes));
                fragranceComposition.appendChild(createNoteCategory(this.currentLang === 'en' ? 'Heart Notes' : 'النوتات الوسطى', result.heartNotes));
                fragranceComposition.appendChild(createNoteCategory(this.currentLang === 'en' ? 'Base Notes' : 'النوتات القاعدية', result.baseNotes));

                document.getElementById('confidenceScore').textContent = this.currentLang === 'en' ?
                    `Confidence Score: ${result.confidence}%` :
                    `نسبة الثقة: ${result.confidence}%`;

                resultSection.scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                console.error('Failed to show result:', error);
            }
        }
    };

    PerfumeGenerator.init();
</script>
</body>
</html>
